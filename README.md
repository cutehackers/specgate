# SpecGate

SpecGate is a lightweight workflow pack for Spec-driven Development (SDD).
It provides command surfaces and scripts for Claude, OpenCode, and Codex.

Install directly into your project without cloning.

- Default install path: current directory (`.`)
- Default scope: all agents (`all` by default). Single-agent install is recommended below.
- Entry points:
  - `/feature-set`
  - `/specify`
  - `/clarify`
  - `/codify`
  - `/checklist`
  - `/analyze`
  - `/test-specify`
  - `/test-codify`
  - `/taskstoissues`
  - `/constitution`
  - `/feature-done`

## Standard feature pipeline

- `/specify -> /clarify -> /codify -> /test-specify -> /test-codify`
- `/specify` must produce `spec.md`, `research.md`.
- `/clarify` must produce and maintain all of: `data-model.md`, `screen_abstraction.md`, `quickstart.md`, `tasks.md`.
- `/codify` must only implement code from the `/clarify` artifacts and `tasks.md`.
- `/test-specify` then `/test-codify` consume `test-spec.md` artifacts.
- `specs/feature-stage.local.json` is the local run-time pointer.
  - It is created in consumer projects by `/feature-set`.
  - It is intentionally excluded from this package distribution.

## 1) Quick start

Install SpecGate:

```bash
curl -fsSL https://raw.githubusercontent.com/cutehackers/specgate/main/install.sh -o /tmp/specgate-install.sh
bash /tmp/specgate-install.sh --ai claude --prefix .
```

Verify:

```bash
ls -la .specify .claude
```

You should see the folders for your selected agent.
For Codex, run workflows via `.codex/skills/specgate/<workflow>/SKILL.md` directly.  
If a workflow needs additional input, ask it directly in the Codex chat (do not rely on `AskUserQuestion`).

## 2) Install modes

### Remote install (single agent)

```bash
curl -fsSL https://raw.githubusercontent.com/cutehackers/specgate/main/install.sh -o /tmp/specgate-install.sh
bash /tmp/specgate-install.sh --ai claude --prefix .
```

### Install by agent (single agent)

1) Claude only

```bash
curl -fsSL https://raw.githubusercontent.com/cutehackers/specgate/main/install.sh -o /tmp/specgate-install.sh \
  && bash /tmp/specgate-install.sh --ai claude --prefix .
```

2) Opencode only

```bash
curl -fsSL https://raw.githubusercontent.com/cutehackers/specgate/main/install.sh -o /tmp/specgate-install.sh \
  && bash /tmp/specgate-install.sh --ai opencode --prefix .
```

3) Codex in project scope (default for project install)

```bash
curl -fsSL https://raw.githubusercontent.com/cutehackers/specgate/main/install.sh -o /tmp/specgate-install.sh \
  && bash /tmp/specgate-install.sh --ai codex --codex-target project --prefix .
```

4) Codex in home scope (shared across projects)

```bash
curl -fsSL https://raw.githubusercontent.com/cutehackers/specgate/main/install.sh -o /tmp/specgate-install.sh \
  && bash /tmp/specgate-install.sh --ai codex --codex-target home --prefix .
```

### Installation mapping guide (single agent)

- Claude: install target becomes `.claude/commands/specgate/*`.
- Opencode: install target becomes `.opencode/command/*`.
- Codex + `--codex-target project`: `.codex/skills/specgate/*`.
- Codex + `--codex-target home`: `~/.codex/skills/specgate/*` (shared by projects).

`--ai` and `--agent` are aliases.
Supported values: `all`, `claude`, `codex`, `opencode`.
(`--ai all` is not recommended for this guide, use one agent per install.)

### Install from local clone

```bash
/path/to/specgate/install.sh --ai claude --prefix .
```

## 3) Install options

```text
--prefix <path>     Install target directory (default: .)
--dry-run           Show plan only; no files are changed
--force             Overwrite existing target files/directories (no backup)
--update            Update only changed files in-place (no backup)
--clean             Remove selected SpecGate assets and reinstall
--version <name>    Install from branch/tag (default: main)
--ai <list>         Install scope
--agent <list>      Alias for --ai
--codex-target <project|home>  Where to install Codex Agent Skills when --ai includes codex (default: project)
--uninstall         Remove SpecGate assets instead of installing
```

Notes:
- No backup files are generated by `install`, `uninstall`, `clean`, or `update`.
- `--update` is safe to run repeatedly: unchanged files are skipped and only changed files are updated.

### Examples

```bash
curl -fsSL https://raw.githubusercontent.com/cutehackers/specgate/main/install.sh -o /tmp/specgate-install.sh
bash /tmp/specgate-install.sh --dry-run --ai codex --codex-target project --prefix .
```

```bash
# Reset a broken or partial existing install in place
curl -fsSL https://raw.githubusercontent.com/cutehackers/specgate/main/install.sh -o /tmp/specgate-install.sh
bash /tmp/specgate-install.sh --clean --ai claude --prefix .
```

```bash
# Update only changed files
curl -fsSL https://raw.githubusercontent.com/cutehackers/specgate/main/install.sh -o /tmp/specgate-install.sh
bash /tmp/specgate-install.sh --update --ai claude --prefix .
```

```bash
curl -fsSL https://raw.githubusercontent.com/cutehackers/specgate/main/install.sh -o /tmp/specgate-install.sh
bash /tmp/specgate-install.sh --version v0.0.0 --prefix .
```

## 4) Uninstall

```bash
curl -fsSL https://raw.githubusercontent.com/cutehackers/specgate/main/install.sh -o /tmp/specgate-install.sh
bash /tmp/specgate-install.sh --uninstall --prefix .
```

`--uninstall` without `--ai` removes all agents by default.
To remove only one agent:

```bash
curl -fsSL https://raw.githubusercontent.com/cutehackers/specgate/main/install.sh -o /tmp/specgate-install.sh
bash /tmp/specgate-install.sh --uninstall --ai claude --prefix .
```

Verify removal of all SpecGate assets:

```bash
[ ! -d .specify ] \
  && [ ! -d .claude/commands/specgate ] \
  && ( [ ! -f .claude/hooks/statusline.js ] || ! (grep -qF "# @specgate-managed:statusline" .claude/hooks/statusline.js || grep -qF "Claude Code Statusline - SpecGate Edition" .claude/hooks/statusline.js) ) \
  && [ ! -d .codex/skills/specgate ] \
  && [ ! -d .opencode/command ] \
  && [ ! -f docs/SPECGATE.md ] \
  && echo "SpecGate assets removed."
```

`statusline.js` is removed only if it was added by SpecGate (to avoid deleting custom user-installed statusline scripts).
`--update` also skips `statusline.js` unless it has SpecGate ownership markers.

If you installed Codex in home scope, remove with:

```bash
curl -fsSL https://raw.githubusercontent.com/cutehackers/specgate/main/install.sh -o /tmp/specgate-install.sh
bash /tmp/specgate-install.sh --uninstall --ai codex --codex-target home --prefix .
```

```bash
[ ! -d ~/.codex/skills/specgate ] && echo "Codex home skills removed."
```

## 5) Installed assets

- `.specify/*`
- `.claude/commands/specgate/*`
- `.claude/hooks/statusline.js`
- `.codex/skills/specgate/*` (project install: `.codex/skills/specgate`, or home install: `~/.codex/skills/specgate`)
  - Includes workflow-dedicated skills: `feature-set`, `specify`, `clarify`, `codify`, `checklist`, `analyze`, `test-specify`, `test-codify`, `taskstoissues`, `constitution`, `feature-done`
- `.opencode/command/*`
- `docs/SPECGATE.md`

Note: `.specify` and `docs/SPECGATE.md` are always installed together for single-agent installs (`--ai codex`, `--ai claude`, etc.).

## 6) Recommended checks (instead of daily smoke check)

Run from repository root:

```bash
bash -n .specify/scripts/bash/check-code-prerequisites.sh \
  .specify/scripts/bash/check-implementation-readiness.sh \
  .specify/scripts/bash/check-implementation-quality.sh \
  .specify/scripts/bash/check-spec-prerequisites.sh \
  .specify/scripts/bash/check-test-prerequisites.sh \
  .specify/scripts/bash/check-test-coverage-targets.sh \
  .specify/scripts/bash/specgate-sync-pointer.sh \
  .specify/scripts/bash/specgate-status.sh \
  .specify/scripts/bash/setup-code.sh \
  .specify/scripts/bash/setup-test-spec.sh

./.specify/scripts/bash/specgate-status.sh
```

`specgate-smoke-check.sh` remains available as an installation validation script, but is not recommended as a routine daily check.

For detailed operation guidance, see `docs/SPECGATE.md`.

## Korean version

- [README-ko.md](./README-ko.md)
